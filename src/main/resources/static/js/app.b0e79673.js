(function(){"use strict";var t={8044:function(t,e,a){var n=a(9242),o=a(3396);const r={key:0};function i(t,e,a,n,i,s){const l=(0,o.up)("router-link"),c=(0,o.up)("router-view");return(0,o.wg)(),(0,o.iD)("div",null,[t.isLoggedIn?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("nav",r,[(0,o.Wm)(l,{to:"/"},{default:(0,o.w5)((()=>[(0,o.Uk)("Login")])),_:1}),(0,o.Uk)(" | "),(0,o.Wm)(l,{to:"/register"},{default:(0,o.w5)((()=>[(0,o.Uk)("Register")])),_:1}),(0,o.Uk)(" | "),(0,o.Wm)(l,{to:"/info"},{default:(0,o.w5)((()=>[(0,o.Uk)("Info")])),_:1}),(0,o.Uk)(" | "),(0,o.Wm)(l,{to:"/demo"},{default:(0,o.w5)((()=>[(0,o.Uk)("Demo")])),_:1}),(0,o.Uk)(" | "),(0,o.Wm)(l,{to:"/how-to-use"},{default:(0,o.w5)((()=>[(0,o.Uk)("How to Use")])),_:1})])),(0,o._)("main",null,[(0,o.Wm)(c)])])}var s=a(7327),l=a(6520),c=a(65),u=(0,c.MT)({state:{sync:[],dashboardData:[],clientData:null},mutations:{setDashboardData(t,e){t.dashboardData=e},setClientData(t,e){t.clientData=e},setSync(t,e){t.sync=e}},actions:{fireSync({commit:t},e){t("setSync",e)},setDashboardDataSyncCount({commit:t},e){const a=this.state.dashboardData.map((t=>t.metadataId!=e.metadataId?t:e));console.log("for setDashboardData",e),t("setDashboardData",a)},updateDashboardData({commit:t},e){t("setDashboardData",e)},addDashboardData({commit:t},e){const a=[...this.state.dashboardData,...e].sort(((t,e)=>t.metadataId>e.metadataId?-1:1));t("setDashboardData",a)},updateClientData({commit:t},e){t("setClientData",e)},updateclientIdandSecrect({commit:t},e){const a={clientId:e.clientId,clientSecret:e.clientSecret,myLoginToken:this.state.clientData?.myLoginToken??"",stravaToken:this.state.clientData?.stravaToken??null,username:this.state.clientData?.username??""};t("setClientData",a)},setClientStravaData({commit:t},e){const a=this.state.clientData,n={clientId:a?.clientId??"",clientSecret:a?.clientSecret??"",myLoginToken:a?.myLoginToken??"",username:a?.username??"",stravaToken:{accessToken:e.accessToken,refreshToken:e.refreshToken}};t("setClientData",n)}},getters:{getDashboardData(t){return t.dashboardData},getClientData(t){return t.clientData},getSync(t){return t.sync}}});class d extends l.w3{constructor(...t){super(...t),(0,s.Z)(this,"isLoggedIn",!1)}mounted(){const t=u.getters.getClientData;u.watch((()=>u.getters.getClientData),(t=>{this.isLoggedIn=null!=t?.myLoginToken})),this.isLoggedIn=null!=t?.myLoginToken}}var h=a(89);const p=(0,h.Z)(d,[["render",i]]);var g=p,m=a(2483);const f={class:"login"},w=(0,o._)("h1",null,"Login",-1),y=(0,o._)("label",{for:"username"},"Username:",-1),v=(0,o._)("br",null,null,-1),b=(0,o._)("br",null,null,-1),k=(0,o._)("label",{for:"password"},"Password:",-1),S=(0,o._)("br",null,null,-1),D=(0,o._)("br",null,null,-1),T=(0,o._)("input",{type:"submit",value:"Login"},null,-1);function _(t,e,a,r,i,s){const l=(0,o.up)("Dashboard");return(0,o.wg)(),(0,o.iD)("div",f,[w,(0,o._)("form",{onSubmit:e[2]||(e[2]=(0,n.iM)(((...e)=>t.onLoginSubmit&&t.onLoginSubmit(...e)),["prevent"]))},[y,(0,o.wy)((0,o._)("input",{type:"text",id:"username","onUpdate:modelValue":e[0]||(e[0]=e=>t.username=e),name:"username"},null,512),[[n.nr,t.username]]),v,b,k,(0,o.wy)((0,o._)("input",{type:"password",id:"password","onUpdate:modelValue":e[1]||(e[1]=e=>t.password=e),name:"password"},null,512),[[n.nr,t.password]]),S,D,T],32),(0,o.Wm)(l)])}a(7658);class C{constructor(){(0,s.Z)(this,"ip",""),(0,s.Z)(this,"port","")}getUrl(){return`${this.ip}${this.port}`}getApp(){return`${this.getUrl()}/app`}getRunUrl(){return`${this.getUrl()}/api/runningApp`}getRideUrl(){return`${this.getUrl()}/api/RideApp`}}const I=(new C).getUrl(),R={login:t=>({url:I+"/api/login/",method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})},A={login:t=>({url:I+"/api/login/",method:"POST",body:JSON.stringify(t),header:{"Content-Type":"application/json"}}),refresh:t=>({url:I+"/api/userReload",method:"GET",header:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}),workoutDataInsert:(t,e,a,n)=>({url:I+"/api/workoutDataInsert",method:"POST",header:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({id:e,header:a,csv:n})}),metaDataInsert:(t,e,a)=>({url:I+"/api/metadataInsert",method:"POST",header:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({header:e,csv:a})}),setStravaData(t,e,a){return{url:I+"/api/userSetStravaData",method:"POST",header:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({clientId:e,clientSecret:a})}}};class L{constructor(t,e,a,n,o){(0,s.Z)(this,"clientId",void 0),(0,s.Z)(this,"clientSecret",void 0),(0,s.Z)(this,"username",void 0),(0,s.Z)(this,"myLoginToken",void 0),(0,s.Z)(this,"metadatas",[]),this.username=t,this.myLoginToken=e,this.clientId=a,this.clientSecret=n,this.metadatas=o}toDashboardStruct(){return this.metadatas.map((t=>({averageHeartRate:t.averageHeartRate,averagePower:t.averagePower,averageSpeed:t.averageSpeed,metadataId:t.metadataId,sport:t.sport,startTime:t.startTime,totalDistance:t.totalDistance,totalTime:t.totalTime,workoutDataCount:t.workoutDataCount})))}toStore(){const t={clientId:this.clientId,clientSecret:this.clientSecret,myLoginToken:this.myLoginToken,username:this.username,stravaToken:null};u.dispatch("updateDashboardData",this.toDashboardStruct()),u.dispatch("updateClientData",t)}static fromJson(t){console.log(t);const e=t.metadatas.map((t=>({metadataId:t.id,sport:t.sport,startTime:t.startTime,totalDistance:t.totalDistance,totalTime:t.totalTime,workoutDataCount:t.count,averageHeartRate:t.averageHearRate,averagePower:t.averagePower,averageSpeed:t.averageSpeed})));return sessionStorage.setItem("accessToken",t.myLoginToken),document.cookie=`accessToken=${t.myLoginToken}`,new L(t.username,t.myLoginToken,t.clientId,t.clientSecret,e)}}var O=function(t,e,a,n){var o,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(i=(r<3?o(i):r>3?o(e,a,i):o(e,a))||i);return r>3&&i&&Object.defineProperty(e,a,i),i};let j=class extends l.w3{constructor(...t){super(...t),(0,s.Z)(this,"username",""),(0,s.Z)(this,"password","")}onLoginSubmit(){const t={username:this.username,password:this.password},e=R.login(t),a=(new C).getUrl();fetch(a+"/api/login",{method:e.method,body:e.body,headers:e.headers}).then((async t=>(console.log(t),t.json()))).then((t=>{console.log(t);let e=L.fromJson(t);e.toStore(),this.$router.push({name:"Dashboard"})})).catch((t=>{alert("login faild")}))}};j=O([(0,l.Ei)({})],j);var P=j;const Z=(0,h.Z)(P,[["render",_]]);var U=Z;const z={class:"register"},W=(0,o._)("h1",null,"Register",-1),x=(0,o._)("label",{for:"username"},"Username:",-1),M=(0,o._)("br",null,null,-1),q=(0,o._)("br",null,null,-1),E=(0,o._)("label",{for:"password"},"Password:",-1),H=(0,o._)("br",null,null,-1),N=(0,o._)("br",null,null,-1),$=(0,o._)("label",{for:"password"},"Repeat Password:",-1),F=(0,o._)("br",null,null,-1),V=(0,o._)("br",null,null,-1),J=(0,o._)("input",{type:"submit",value:"Register"},null,-1);function B(t,e,a,r,i,s){return(0,o.wg)(),(0,o.iD)("div",z,[W,(0,o._)("form",{onSubmit:e[3]||(e[3]=(0,n.iM)(((...e)=>t.registerUser&&t.registerUser(...e)),["prevent"]))},[x,(0,o.wy)((0,o._)("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=e=>t.username=e),id:"username",name:"username"},null,512),[[n.nr,t.username]]),M,q,E,(0,o.wy)((0,o._)("input",{type:"password","onUpdate:modelValue":e[1]||(e[1]=e=>t.password=e),id:"password",name:"password"},null,512),[[n.nr,t.password]]),H,N,$,(0,o.wy)((0,o._)("input",{type:"password","onUpdate:modelValue":e[2]||(e[2]=e=>t.repeatPassword=e),id:"repeatPassword",name:"repeatPassword"},null,512),[[n.nr,t.repeatPassword]]),F,V,J],32)])}class G extends l.w3{constructor(...t){super(...t),(0,s.Z)(this,"username",""),(0,s.Z)(this,"password",""),(0,s.Z)(this,"repeatPassword","")}registerUser(){const t=(new C).getUrl();if(this.password!==this.repeatPassword)return void alert("Passwords do not match.");const e={username:this.username,password:this.password};fetch(t+"/api/userCreate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(e.ok){const e={username:this.username,password:this.password},a=R.login(e);console.log(t),fetch(t+"/api/login",{method:a.method,body:a.body,headers:a.headers}).then((async t=>(console.log(t),t.json()))).then((t=>{console.log(t);let e=L.fromJson(t);e.toStore(),this.$router.push({name:"Dashboard"})})),alert("Registration successful.")}else alert("Registration failed.")})).catch((t=>{console.error("Error:",t),alert("An error occurred during registration.")}))}}const Y=(0,h.Z)(G,[["render",B]]);var K=Y,Q=a(7139);const X={class:"dashboard"},tt={class:"main-content"},et={key:0},at=(0,o._)("div",null,[(0,o._)("h2",null," Authentication in Strava Success ")],-1),nt=(0,o._)("label",{for:"loadLatestMetadata"},null,-1),ot=(0,o._)("label",{for:"loadAllMetadata"},null,-1),rt=(0,o._)("br",null,null,-1),it=(0,o._)("br",null,null,-1),st={key:1,class:"clientInfo"},lt=(0,o._)("label",{for:"clientId"},"client ID:",-1),ct=(0,o._)("br",null,null,-1),ut=(0,o._)("br",null,null,-1),dt=(0,o._)("label",{for:"clientSecret"},"client Secret:",-1),ht=(0,o._)("br",null,null,-1),pt=(0,o._)("br",null,null,-1),gt=(0,o._)("br",null,null,-1),mt=(0,o._)("br",null,null,-1),ft={key:2},wt={class:"button-bar"};function yt(t,e,a,r,i,s){const l=(0,o.up)("DashboardTable");return(0,o.wg)(),(0,o.iD)("div",X,[(0,o._)("div",tt,[(0,o._)("h1",null," Welcome "+(0,Q.zw)(t.client?.username),1),t.isStravaLoggin?((0,o.wg)(),(0,o.iD)("div",et,[at,(0,o._)("div",null,[nt,(0,o._)("input",{type:"submit",value:"loadLatestMetadata",onClick:e[0]||(e[0]=(...e)=>t.onLoadLatestMetadata&&t.onLoadLatestMetadata(...e))}),ot,(0,o._)("input",{type:"submit",value:"loadAllMetadata",onClick:e[1]||(e[1]=(...e)=>t.onLoadAllMetadata&&t.onLoadAllMetadata(...e))}),rt,it,(0,o._)("button",{onClick:e[2]||(e[2]=(...e)=>t.onBulkSync&&t.onBulkSync(...e))},"bulkSync")])])):(0,o.kq)("",!0),t.isStravaLoggin?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",st,[(0,o._)("div",null,[(0,o._)("button",{onClick:e[3]||(e[3]=(...e)=>t.openHelpWindow&&t.openHelpWindow(...e))},"Help")]),lt,(0,o.wy)((0,o._)("input",{type:"text",id:"clientId",name:"clientId","onUpdate:modelValue":e[4]||(e[4]=e=>t.clientId=e)},null,512),[[n.nr,t.clientId]]),ct,ut,dt,(0,o.wy)((0,o._)("input",{type:"password",id:"clientSecret",name:"clientSecret","onUpdate:modelValue":e[5]||(e[5]=e=>t.clientSecret=e)},null,512),[[n.nr,t.clientSecret]]),ht,pt,(0,o._)("input",{type:"submit",value:"OAuth",onClick:e[6]||(e[6]=(...e)=>t.onOauthLogin&&t.onOauthLogin(...e))})])),gt,mt,t.isLoading?((0,o.wg)(),(0,o.iD)("div",ft," The metadata you have at this time is in the loading process "+(0,Q.zw)(t.foundData)+" workouts ",1)):(0,o.kq)("",!0),(0,o.Wm)(l)]),(0,o._)("footer",wt,[t.isRideAppReady?((0,o.wg)(),(0,o.iD)("button",{key:0,onClick:e[7]||(e[7]=(...e)=>t.onRunApp&&t.onRunApp(...e))},"RUN")):(0,o.kq)("",!0),t.isRunningAppReady?((0,o.wg)(),(0,o.iD)("button",{key:1,onClick:e[8]||(e[8]=(...e)=>t.onRideApp&&t.onRideApp(...e))},"RIDE")):(0,o.kq)("",!0)])])}a(2062);const vt={class:"content"},bt=(0,o._)("h1",null,"Dashboard",-1),kt=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",null,"Metadata ID"),(0,o._)("th",null,"Sport"),(0,o._)("th",null,"Start Time"),(0,o._)("th",null,"Average Power"),(0,o._)("th",null,"Average Speed"),(0,o._)("th",null,"Average Heart Rate"),(0,o._)("th",null,"Total Time"),(0,o._)("th",null,"Total Distance"),(0,o._)("th",null," Count"),(0,o._)("th",null,"actions")])],-1);function St(t,e,a,n,r,i){const s=(0,o.up)("DashboardRow");return(0,o.wg)(),(0,o.iD)("div",vt,[bt,(0,o._)("table",null,[kt,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.rowData,(t=>((0,o.wg)(),(0,o.iD)("tbody",{key:t.metadata.metadataId},[(0,o.Wm)(s,{msg:t.metadata,autoSync:t.autoSync,bulkSync:t.bulkSync},null,8,["msg","autoSync","bulkSync"])])))),128))])])}function Dt(t,e,a,n,r,i){return(0,o.wg)(),(0,o.iD)("tr",null,[(0,o._)("td",null,(0,Q.zw)(t.msg.metadataId),1),(0,o._)("td",null,(0,Q.zw)(t.msg.sport),1),(0,o._)("td",null,(0,Q.zw)(t.msg.startTime),1),(0,o._)("td",null,(0,Q.zw)(t.msg.averagePower),1),(0,o._)("td",null,(0,Q.zw)(t.msg.averageSpeed),1),(0,o._)("td",null,(0,Q.zw)(t.msg.averageHeartRate),1),(0,o._)("td",null,(0,Q.zw)(t.msg.totalTime),1),(0,o._)("td",null,(0,Q.zw)(t.msg.totalDistance),1),(0,o._)("td",null,(0,Q.zw)(t.msg.workoutDataCount),1),(0,o._)("td",null,[t.isReadyToSync?((0,o.wg)(),(0,o.iD)("button",{key:0,onClick:e[0]||(e[0]=(...e)=>t.getWorkout&&t.getWorkout(...e))},"sync")):(0,o.kq)("",!0)])])}const Tt="id,lat,long,timerTime,power,speed,heartRate";function _t(t,e){const a=Tt.split(","),n=e.latlng.data.map((t=>t[0])),o=e.latlng.data.map((t=>t[1])),r=e.time?.data??Array(n.length).fill(-1),i=e.watts?.data??Array(n.length).fill(-1),s=e.velocity_smooth?.data??Array(n.length).fill(-1),l=e.heartrate?.data??Array(n.length).fill(-1),c=[];for(let u=0;u<n.length;u++){const e=a.map((e=>{switch(e){case"id":return t;case"lat":return n[u]?.toString()??"";case"long":return o[u]?.toString()??"";case"timerTime":return r[u]?.toString()??"";case"power":return i[u]?.toString()??"";case"speed":return s[u]?3.6*s[u]:0;case"heartRate":return l[u]?.toString()??"";default:return""}}));c.push(e.join(","))}return{header:Tt,CSV:c.join("\n")}}const Ct="id,sport,startTime,averagePower,averageSpeed,averageHearRate,totalTime,totalDistance",It=t=>({averageHeartRate:t.average_heartrate,averagePower:t.average_watts,averageSpeed:3.6*t.average_speed,metadataId:t.id,sport:t.type,startTime:t.start_date,totalDistance:t.distance,totalTime:t.elapsed_time,workoutDataCount:0}),Rt=t=>t.map((t=>It(t)));function At(t){const e=Ct.split(","),a=e.map((e=>{switch(e){case"id":return t.metadataId;case"sport":return t?.sport??"";case"startTime":return t?.startTime??"";case"averagePower":return t?.averagePower?.toString()??"";case"averageSpeed":return t?.averageSpeed?.toString()??"";case"averageHearRate":return t?.averageHeartRate?.toString()??"";case"totalTime":return t?.totalTime?.toString()??"";case"totalDistance":return t?.totalDistance?.toString()??"";default:return""}}));return a.join(",")}function Lt(t){return{header:Ct,CSV:t.map((t=>At(t))).join("\n")}}const Ot="low",jt="https://www.strava.com/api/v3",Pt=t=>jt+"/athlete/activities?unit_system=metric&page="+t,Zt=(t,e)=>jt+"/activities/"+t+"/streams?keys=latlng,watts,heartrate,time,velocity_smooth&resolution="+e+"&key_by_type=true",Ut=t=>({getMetadata:e=>({header:{"Content-Type":"application/json",Authorization:"Bearer "+t.accessToken},method:"GET",url:Pt(e)}),getWorkout:e=>({header:{"Content-Type":"application/json",Authorization:"Bearer "+t.accessToken},method:"GET",url:Zt(e,Ot)}),getWorkoutWithResolution:(e,a)=>({header:{"Content-Type":"application/json",Authorization:"Bearer "+t.accessToken},method:"GET",url:Zt(e,a)})});async function*zt(t){const e=Ut(t).getMetadata;let a=1,n=0;const o=[];do{const t=e(a),r=await(await fetch(t.url,{method:t.method,headers:t.header})).json();n=r.length,0!==n&&(o.push(...Rt(r)),yield{data:o,msg:"load"}),a++}while(0!==n);return yield{data:o,msg:"finished"}}var Wt=function(t,e,a,n){var o,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(i=(r<3?o(i):r>3?o(e,a,i):o(e,a))||i);return r>3&&i&&Object.defineProperty(e,a,i),i};let xt=class extends l.w3{constructor(...t){super(...t),(0,s.Z)(this,"autoSync",void 0),(0,s.Z)(this,"bulkSync",void 0),(0,s.Z)(this,"msg",void 0),(0,s.Z)(this,"client",void 0),(0,s.Z)(this,"isReadyToSync",!1)}getWorkout(){if(console.log(""),0==this.isReadyToSync)return void console.log("no sync");this.isReadyToSync=!1;const t=u.getters.getClientData;if(t&&t.stravaToken){const e=Ut(t.stravaToken).getWorkout(this.msg.metadataId);fetch(e.url,{method:e.method,headers:e.header}).then((async t=>{console.log(t);const e=await t.json();let a=_t(this.msg.metadataId,e);if(null!=this.client){console.log(e.time.data.length),this.msg.workoutDataCount=e.time.data.length;let t=A.workoutDataInsert(this.client?.myLoginToken,this.msg.metadataId,a.header,a.CSV);fetch(t.url,{method:t.method,body:t.body,headers:t.header}).then((t=>{console.log("response success"),u.dispatch("setDashboardDataSyncCount",this.msg)}))}}))}}mounted(){this.client=u.getters.getClientData,this.isReadyToSync=null!=this.client?.stravaToken?.accessToken&&0==this.msg.workoutDataCount,u.watch((()=>u.getters.getSync),(t=>{this.bulkSync&&(console.log(this.msg.metadataId),this.getWorkout())})),this.autoSync&&this.getWorkout()}};xt=Wt([(0,l.Ei)({props:{msg:{type:Object},autoSync:{type:Object},bulkSync:{type:Object}}})],xt);var Mt=xt;const qt=(0,h.Z)(Mt,[["render",Dt]]);var Et=qt,Ht=function(t,e,a,n){var o,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(i=(r<3?o(i):r>3?o(e,a,i):o(e,a))||i);return r>3&&i&&Object.defineProperty(e,a,i),i};let Nt=class extends l.w3{constructor(...t){super(...t),(0,s.Z)(this,"rowData",[]),(0,s.Z)(this,"dashboardData",[])}mounted(){var t=u.getters.getDashboardData;console.log(t),this.dashboardData=t;let e=30,a=0;this.rowData=this.dashboardData.map(((t,n)=>{const o=t.workoutDataCount>1;return a=o?a+1:a,{metadata:t,autoSync:n<=e+a&&!o,bulkSync:e+a<n&&n<=a+2*e&&!o}})),u.watch((()=>u.getters.getDashboardData),(t=>{this.dashboardData=t;let a=0;this.rowData=this.dashboardData.map(((t,n)=>{const o=t.workoutDataCount>1;return a=o?a+1:a,{metadata:t,autoSync:n<=e+a&&!o,bulkSync:e+a<n&&n<=a+2*e&&!o}})),console.log(this.rowData)})),console.log(this.rowData)}};Nt=Ht([(0,l.Ei)({components:{DashboardRow:Et},props:{msg:{type:[],required:!0}}})],Nt);var $t=Nt;const Ft=(0,h.Z)($t,[["render",St]]);var Vt=Ft;class Jt{constructor(){(0,s.Z)(this,"ip",""),(0,s.Z)(this,"port","")}getUrl(){return`${this.ip}${this.port}`}}var Bt=function(t,e,a,n){var o,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(i=(r<3?o(i):r>3?o(e,a,i):o(e,a))||i);return r>3&&i&&Object.defineProperty(e,a,i),i};let Gt=class extends l.w3{constructor(...t){super(...t),(0,s.Z)(this,"client",null),(0,s.Z)(this,"clientId",""),(0,s.Z)(this,"clientSecret",""),(0,s.Z)(this,"myToken",""),(0,s.Z)(this,"isStravaLoggin",!1),(0,s.Z)(this,"isLoading",!1),(0,s.Z)(this,"foundData",0),(0,s.Z)(this,"isRunningAppReady",!1),(0,s.Z)(this,"isRideAppReady",!1),(0,s.Z)(this,"server",new C),(0,s.Z)(this,"uiServer",new Jt)}openHelpWindow(){window.open("/how-to-use","_blank")}onLoadLatestMetadata(){if(this.client&&this.client.stravaToken){let t=Ut(this.client.stravaToken).getMetadata(1);fetch(t.url,{method:t.method,headers:t.header}).then((async t=>{let e=await t.json();const a=Rt(e),n=u.getters.getDashboardData,o=a.filter((t=>0==n.filter((e=>e.metadataId==t.metadataId)).length));let r=Lt(o);if(console.log(r),null!=this.client){u.dispatch("addDashboardData",o);let t=A.metaDataInsert(this.client.myLoginToken,r.header,r.CSV);fetch(t.url,{method:t.method,body:t.body,headers:t.header})}}))}}async onLoadAllMetadata(){if(null!=this.client&&this.client.stravaToken){const t=zt(this.client.stravaToken);for await(const e of t)if(this.isLoading=!0,console.log(e),this.foundData=e.data.length,"finished"==e.msg){this.isLoading=!1;const t=u.getters.getDashboardData,a=e.data,n=a.filter((e=>0==t.filter((t=>t.metadataId==e.metadataId)).length));console.log("newdata",n);const o=Lt(n),r=A.metaDataInsert(this.client.myLoginToken,o.header,o.CSV);u.dispatch("addDashboardData",n),fetch(r.url,{method:r.method,body:r.body,headers:r.header})}}}onOauthLogin(){console.log(this.myToken);let t="https://www.strava.com/oauth/authorize?client_id="+this.clientId+"&response_type=code&redirect_uri="+new URL(document.URL).origin+"/OAuthFlow&approval_prompt=force&scope=read_all,activity:read_all,profile:read_all";console.log("oauth",this.clientId),u.dispatch("updateclientIdandSecrect",{clientId:this.clientId,clientSecret:this.clientSecret});const e=A.setStravaData(this.myToken,this.clientId,this.clientSecret);console.log(e),fetch(e.url,{method:e.method,body:e.body,headers:e.header}),window.location.assign(t)}onBulkSync(){console.log(""),u.dispatch("fireSync",[])}onRunApp(){console.log("runapp"),sessionStorage.setItem("url",this.server.getRunUrl()),sessionStorage.setItem("accessToken",this.client?.myLoginToken??""),window.location.assign(new URL(document.URL).origin+"/app")}onRideApp(){console.log("rideApp"),sessionStorage.setItem("url",this.server.getRideUrl()),sessionStorage.setItem("accessToken",this.client?.myLoginToken??""),window.location.assign(new URL(document.URL).origin+"/app")}mounted(){this.client=u.getters.getClientData,console.log(this.client),this.clientId=this.client?.clientId??"",this.clientSecret=this.client?.clientSecret??"",this.myToken=this.client?.myLoginToken??"notoken",this.client=u.getters.getClientData,null!=this.client.stravaToken&&(this.isStravaLoggin=!0),u.watch((()=>u.getters.getDashboardData),(t=>{let e=t.filter((t=>"Run"==t.sport)).filter((t=>t.workoutDataCount>1)).length,a=t.filter((t=>"Ride"==t.sport)).filter((t=>t.workoutDataCount>1)).length;console.log("run count",e),this.isRideAppReady=e>1,this.isRunningAppReady=a>1}));var t=u.getters.getDashboardData;let e=t.filter((t=>"Run"==t.sport)).filter((t=>t.workoutDataCount>1)).length,a=t.filter((t=>"Ride"==t.sport)).filter((t=>t.workoutDataCount>1)).length;console.log("run count",e),this.isRideAppReady=e>1,this.isRunningAppReady=a>1}};Gt=Bt([(0,l.Ei)({components:{DashboardTable:Vt}})],Gt);var Yt=Gt;const Kt=(0,h.Z)(Yt,[["render",yt]]);var Qt=Kt;const Xt=(0,o._)("h1",null,"OAutho Flow",-1);function te(t,e,a,n,r,i){return(0,o.wg)(),(0,o.iD)("div",null,[Xt,(0,o._)("p",null,"client: "+(0,Q.zw)(t.client?.username),1),(0,o._)("p",null,"client: "+(0,Q.zw)(t.client?.clientId),1),(0,o._)("p",null,"client: "+(0,Q.zw)(t.client?.clientSecret),1),(0,o._)("p",null,"jwt token: "+(0,Q.zw)(t.myToken),1),(0,o._)("p",null,"Authorization code: "+(0,Q.zw)(t.authorizationCode),1),(0,o._)("button",{onClick:e[0]||(e[0]=(...e)=>t.onClick&&t.onClick(...e))},"click me")])}class ee extends l.w3{constructor(...t){super(...t),(0,s.Z)(this,"client",null),(0,s.Z)(this,"dashboardData",[])}get authorizationCode(){return this.$route.query.code}get myToken(){const t=sessionStorage.getItem("accessToken")??"";return console.log(t),t}onClick(){this.logInStrava()}logInStrava(){const t=new URLSearchParams;var e={clientId:this.client?.clientId??"",ClientSecret:this.client?.clientSecret??"",Code:this.authorizationCode};console.log("keys,",e),t.append("client_id",e.clientId),t.append("client_secret",e.ClientSecret),t.append("code",e.Code),t.append("grant_type","authorization_code"),t.append("Content-Type","application/x-www-form-urlencoded");const a="https://www.strava.com/oauth/token";console.log("form",t.toString()),fetch(a,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t.toString()}).then((t=>(console.log(t),t.json()))).then((t=>{console.log(t);const e={accessToken:t.access_token,refreshToken:t.refresh_token};u.dispatch("setClientStravaData",e);const a=JSON.parse(JSON.stringify(u.getters.getClientData));console.log(a.stravaToken),this.$router.push({name:"Dashboard"})}))}mounted(){const t=A.refresh(this.myToken);console.log(t.url),console.log(t.header),fetch(t.url,{method:t.method,headers:t.header}).then((t=>t.json())).then((t=>{let e=L.fromJson(t);e.toStore(),this.client=u.getters.getClientData,console.log(this.client),this.logInStrava()}))}}const ae=(0,h.Z)(ee,[["render",te]]);var ne=ae;const oe={class:"container"},re=(0,o.uE)('<h1>MaxiPutz.github.io</h1><h3>Quick view into the App</h3><h4>What can I do with this App?</h4><p>Compare the performance data of routes which you frequently use for your Workout. For example, if you run the same route every day, you might want to know your performance over time. You can graphically compare and analyze these data with this app.</p><h4>What do I see on the homepage?</h4><p>All Workouts!</p><img src="https://user-images.githubusercontent.com/48091139/228637792-45201524-15bf-450a-9740-7a274dcdc662.jpg" alt="Screenshot of homepage"><h4>What happens if I click on a blue Workout-card/button?</h4><p>This Workout is shown then in Detail:</p><img src="https://user-images.githubusercontent.com/48091139/228636530-f73bcecd-3653-4533-84f7-d98ccf1c0422.jpg" alt="Screenshot of Workout detail view"><h4>What&#39;s the use of the CREATE-button in the header bar?</h4><p>Select a frequent Workout segment (part of the route) on the map.</p><p>Ok, but how can I select my segment of interest from point A to point B?</p><ol><li>Click CREATE</li><li>Drag &amp; drop the pins on the map:</li><ul><li>green pin to the desired start point</li><li>red pin to the end point (segment will appear green)</li></ul><li>Click the yellow LOAD button in the header bar to view the graphical comparison of multiple Workouts of one route:</li></ol><img src="https://user-images.githubusercontent.com/48091139/228637416-43bb6465-c071-48af-be8f-f9895f89a904.jpg" alt="Screenshot of segment selection"><p>Load all runs with this segment and compare it with the mean data from</p><img src="https://user-images.githubusercontent.com/48091139/228637481-065573b2-8315-4e30-b065-c9eea4deefec.jpg" alt="Screenshot of comparison view">',17),ie=[re];function se(t,e,a,n,r,i){return(0,o.wg)(),(0,o.iD)("div",oe,ie)}class le extends l.w3{}const ce=(0,h.Z)(le,[["render",se]]);var ue=ce;const de={src:"https://maxiputz.github.io/",style:{width:"100%",height:"100vh",border:"none"}};function he(t,e,a,n,r,i){return(0,o.wg)(),(0,o.iD)("iframe",de)}class pe extends l.w3{}const ge=(0,h.Z)(pe,[["render",he]]);var me=ge,fe=a.p+"img/output3.64315625.gif";const we={class:"container"},ye=(0,o.uE)('<h1>Tutorial: Setting Up Not Another Fitness App with Strava API</h1><img style="max-width:100%;margin-bottom:20px;" src="'+fe+'" alt="Animated GIF"><h2>Step 1: Sign up for a Strava Account</h2><p>If you haven&#39;t already, go to <a href="https://www.strava.com/register">Strava registration page</a> and sign up for a Strava account. Follow the instructions to create your account.</p><h2>Step 2: Create an App on Strava</h2><ol><li>After logging in to your Strava account, go to <a href="https://www.strava.com/settings/api">Strava API settings</a>.</li><li>Click on the &quot;Create an App&quot; button to create a new app.</li><li>Fill in the following information for your app:</li></ol><ul><li>Application Name: not-another-fitness</li><li>Category: Visualizer</li><li>Website: <a href="https://not-another-fitness-dje544rcra-no.a.run.app/">https://not-another-fitness-dje544rcra-no.a.run.app/</a></li><li>Authorization Callback Domain: not-another-fitness-dje544rcra-no.a.run.app</li></ul><p>Once you&#39;ve filled in the details, click on the &quot;Create&quot; button to create your app.</p><h2>Step 3: Retrieve Client ID and Client Secret</h2><p>After creating your app, you will be redirected to the &quot;My API Application&quot; page. On this page, you can find the following information:</p><ul><li>Category: The category you chose for your application (Visualizer in this case)</li><li>Client ID: Your application ID</li><li>Client Secret: Your client secret</li></ul><p>Copy the Client ID and Client Secret from the &quot;My API Application&quot; page.</p><h2>Step 4: Configure Not Another Fitness App</h2><ol><li>Register and login to the Not Another Fitness App</li><li>Fill in the Client ID and Client Secret obtained from the previous steps.</li><li>Click on Oauth and authorizate the api for the Not Another Fitness App</li></ol><h2>Step 5: Sync Your Workouts and Have Fun with the App</h2><ol><li>Initiate the workout sync process.</li><li>Once the sync is complete, you will be able to view and analyze your workout data within the app.</li><li>Explore the features and functionalities of the app to make the most out of your fitness data.</li></ol><p>Now you&#39;re all set up with the Not Another Fitness app and Strava API integration. Enjoy tracking and analyzing your workouts!</p>',17),ve=[ye];function be(t,e,a,n,r,i){return(0,o.wg)(),(0,o.iD)("div",we,ve)}class ke extends l.w3{}const Se=(0,h.Z)(ke,[["render",be]]);var De=Se;const Te=[{path:"/",component:U,name:"Login"},{path:"/register",component:K,name:"Register"},{path:"/dashboard",component:Qt,name:"Dashboard"},{path:"/OAuthFLow",component:ne},{path:"/info",component:ue,name:"info"},{path:"/demo",component:me,name:"demo"},{path:"/how-to-use",component:De,name:"HowToUse"}];var _e=(0,m.p7)({history:(0,m.PO)(),routes:Te});const Ce=(0,n.ri)(g);Ce.use(u),Ce.use(_e),Ce.mount("#app")}},e={};function a(n){var o=e[n];if(void 0!==o)return o.exports;var r=e[n]={exports:{}};return t[n].call(r.exports,r,r.exports,a),r.exports}a.m=t,function(){var t=[];a.O=function(e,n,o,r){if(!n){var i=1/0;for(u=0;u<t.length;u++){n=t[u][0],o=t[u][1],r=t[u][2];for(var s=!0,l=0;l<n.length;l++)(!1&r||i>=r)&&Object.keys(a.O).every((function(t){return a.O[t](n[l])}))?n.splice(l--,1):(s=!1,r<i&&(i=r));if(s){t.splice(u--,1);var c=o();void 0!==c&&(e=c)}}return e}r=r||0;for(var u=t.length;u>0&&t[u-1][2]>r;u--)t[u]=t[u-1];t[u]=[n,o,r]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.p="/"}(),function(){var t={143:0};a.O.j=function(e){return 0===t[e]};var e=function(e,n){var o,r,i=n[0],s=n[1],l=n[2],c=0;if(i.some((function(e){return 0!==t[e]}))){for(o in s)a.o(s,o)&&(a.m[o]=s[o]);if(l)var u=l(a)}for(e&&e(n);c<i.length;c++)r=i[c],a.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return a.O(u)},n=self["webpackChunklogin_view"]=self["webpackChunklogin_view"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(8044)}));n=a.O(n)})();
//# sourceMappingURL=app.b0e79673.js.map